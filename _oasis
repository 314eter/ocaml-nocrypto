OASISFormat:  0.4
Name:         nocrypto
Version:      0.1.1
Synopsis:     Simple crypto for the modern age
Authors:      David Kaloper <david@numm.org>
Maintainers:  David Kaloper <david@numm.org>
License:      FreeBSD
Homepage:     https://github.com/mirleft/ocaml-nocrypto
Plugins:      META (0.4), DevFiles (0.4)
BuildTools:   ocamlbuild
Description:
  A simple cryptographic library.


Flag "pedantic"
  Description: Make the C compiler go hardcore
  Default:     false

Flag "benchmarks"
  Description: Build the benchmark programs
  Default:     false

PreConfCommand      : ./build/sizes src/native src/
PreDistcleanCommand : rm -f src/nc_native_sizes.ml
PreCleanCommand     : rm -f src/nc_generated.ml src/native/nc_generated_stubs.c

Executable "ffi_gen"
  MainIs:         ffi_gen.ml
  Install:        false
  Path:           src
  CompiledObject: native
  BuildDepends:   cstruct, ctypes.stubs

Library "nocrypto"
  Path:            src/
#   Pack:            true
#   Modules:         Rng,
#                    Hash,
#                    Stream_cipher,
#                    Block_cipher,
#                    Rsa,
#                    Dh,
#                    Fortuna,
#                    Base64,
#                    Numeric,
#                    Nc_common
#   InternalModules: Nc_native_sizes,
#                    Nc_generated,
#                    Native,
#                    Algo_types,
#                    Gcm
#
  Modules:         Nocrypto
  InternalModules: Native,
                   Nc_native_sizes,
                   Nc_generated,
                   Nc_common,
                   Numeric,
                   Hash,
                   Block_cipher,
                   Fortuna,
                   Rng,
                   Stream_cipher,
                   Gcm,
                   Rsa,
                   Dh,
                   Algo_types,
                   Base64

  CSources:        native/sha2.c,
                   native/sha2.h,
                   native/md5.c,
                   native/md5.h,
                   native/rijndael.c,
                   native/rijndael.h,
                   native/d3des.c,
                   native/d3des.h,
                   native/nc_generated_stubs.c
  BuildDepends:    cstruct, zarith, ctypes, sexplib.syntax
  CCOpt:           -I$pkg_ctypes/..
  BuildTools+:     ffi_gen
  ByteOpt:         -w A-4-33-40-41-42-43-34-44

  if flag(pedantic)
    CCOpt: -Wall -Wpedantic

Library "testlib"
  Path:         tests/
  Modules:      Testlib
  Install:      false
  Build$:       flag(tests)
  BuildDepends: nocrypto, oUnit, cstruct.unix

Executable "test_runner"
  Path:           tests/
  Install:        false
  CompiledObject: best
  MainIs:         testrunner.ml
  Build$:         flag(tests)
  BuildDepends:   testlib

Test the_things
  Command:   $test_runner
  TestTools: test_runner
  Run$:      flag(tests)

Executable "bench"
  Path:           tests/
  Install:        false
  CompiledObject: native
  MainIs:         runnable.ml
  Build$:         flag(tests) && flag(benchmarks)
  BuildDepends:   nocrypto, cstruct, lwt, lwt.syntax, lwt.unix

Executable "hashbench"
  Path:           tests/
  Install:        false
  CompiledObject: native
  MainIs:         hashbench.ml
  Build$:         flag(tests) && flag(benchmarks)
  BuildDepends:   nocrypto, cstruct, cstruct.unix

Document api
  Title: Documentation and API reference
  Type: ocamlbuild (0.3)
  BuildTools+: ocamldoc
  XOcamlbuildPath: doc
  XOcamlbuildModules: src/Nocrypto, src/Rsa, src/Dh
  Install: false
